<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <title>Option 1</title>

    <link href="fontawesome/css/all.min.css?v0.16" rel="stylesheet">
    <link href="figure-ui/css/figure.css?v0.16" rel="stylesheet">
    <link href="style.css?v0.16" rel="stylesheet">

    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="figure-ui/js/figure.js?v0.16"></script>
</head>

<body class="option-1 test">

    <div id="app" v-cloak>

        <div class="experiment-modal fi-modal fi-full-width fi-full-height fi-modal-open fi-modal-visible fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div><a href="https://fw0vah.axshare.com/#g=1&p=home&c=1" class="fi-close-button circle-close"></a></div>

                        <div class="fi-modal-body fi-no-padding">

                            <div class="fi-modal-body-inner">

                                <div class="fi-tabs fi-alt header-tabs">
                                    <ul>
                                        <li><a href="https://fw0vah.axshare.com/#g=1&p=experiment_-_mark___gemma_-_basic_info&c=1" class="fi-tab-button"><i class="far fa-exclamation-circle fi-icon-margin"></i>Basic Info</a></li>
                                        <li><a href="https://fw0vah.axshare.com/#g=1&p=experiment_-_mark___gemma&c=1" class="fi-tab-button"><i class="far fa-magic fi-icon-margin"></i>Design</a></li>
                                        <li class="fi-tab-active"><a href="#" class="fi-tab-button"><i class="far fa-th fi-icon-margin"></i>Plates</a></li>
                                    </ul>
                                </div>

                                <div class="plate-layout-container experiment">

                                    <div class="fi-tabs fi-alt method-tabs">
                                        <ul>
                                            <li class="fi-tab-active"><button type="button" class="fi-tab-button">Method.1.Name</button></li>
                                            <li><button type="button" class="fi-tab-button">Method.2.Name</button></li>
                                            <li><button type="button" class="fi-tab-button">Method.3.Name</button></li>
                                        </ul>
                                        <div class="top-right-buttons">
                                            <div class="fi-form fi-form-inline large-spacing">
                                                <div class="fi-form-field separator"></div>
                                                <div class="fi-form-field">
                                                    <span class="fi-form-label">View plates by</span>
                                                    <div class="custom-dropdown fi-small value">
                                                        <select class="fi-form-control fi-small">
                                                            <option value="roles">Roles</option>
                                                            <option value="test_sample">Test Samples</option>
                                                            <option value="ctrl_w_sample">Control with Sample</option>
                                                            <option value="ctrl_wo_sample">Control without Sample</option>
                                                            <option value="rates">Rates</option>
                                                            <option value="condition_sets">Condition Sets</option>
                                                            <option value="replicates">Replicates</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="fi-form-field separator"></div>
                                                <div class="fi-form-field">
                                                    <button type="button" @click.prevent="" class="fi-button fi-default fi-small generate-with-default-button" data-fi-modal=".generate_using_defaults_modal">
                                                        Generate Plates for All Methods
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="treatments">
                                        <div class="filters-actions">
                                            <div class="filters">
                                                <div class="filters-header">
                                                    <button v-if="filters_active" @click.prevent="clear_filters" type="button" class="fi-button fi-button-icon clear-all-filters">
                                                        Clear all
                                                    </button>
                                                    <h5><strong>Filters</strong></h5>
                                                </div>
                                                <div class="filters-multiple fi-panel">
                                                    <div class="filter-section">
                                                        <div class="fi-dropdown filter-trigger" data-fi-append-to-body>
                                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-small fi-button-icon">
                                                                <span class="label">Condition Sets</span><i class="far fa-angle-down"></i>
                                                            </button>
                                                            <div class="fi-dropdown-content filter-trigger-content fi-large">
                                                                <div class="search-wrapper">
                                                                    <div class="fi-form-field fi-search"><input type="search" placeholder="Search Condition Sets..." class="fi-form-control"></div>
                                                                </div>
                                                                <div class="select-items check-list">
                                                                    <div class="select-items-inner">
                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="item in all_condition_sets">
                                                                                <a href="#" @click.prevent="toggle_filter('condition_set', item)" class="fi-list-link-wrapper select-item" :class="{'selected': filters.condition_set.includes(item)}">{{ item }}</a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="selected-filters">
                                                            <button v-for="item in filters.condition_set" @click.prevent="toggle_filter('condition_set', item)" type="button" class="fi-badge fi-default">{{ item }}<i class="far fa-times"></i></button>
                                                        </div>
                                                        <button v-if="filters.condition_set.length" @click.prevent="filters.condition_set = []" type="button" class="fi-close-button remove-all"></button>
                                                    </div>
                                                    <div class="filter-section">
                                                        <div class="fi-dropdown filter-trigger" data-fi-append-to-body>
                                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-small fi-button-icon">
                                                                <span class="label">Roles</span><i class="far fa-angle-down"></i>
                                                            </button>
                                                            <div class="fi-dropdown-content filter-trigger-content fi-large">
                                                                <div class="search-wrapper">
                                                                    <div class="fi-form-field fi-search"><input type="search" placeholder="Search Roles..." class="fi-form-control"></div>
                                                                </div>
                                                                <div class="select-items check-list">
                                                                    <div class="select-items-inner">
                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="item in all_roles">
                                                                                <a href="#" @click.prevent="toggle_filter('role', item)" class="fi-list-link-wrapper select-item" :class="{'selected': filters.role.includes(item)}">{{ role_names[item] }}</a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="selected-filters">
                                                            <button v-for="item in filters.role" @click.prevent="toggle_filter('role', item)" type="button" class="fi-badge fi-default">{{ role_names[item] }}<i class="far fa-times"></i></button>
                                                        </div>
                                                        <button v-if="filters.role.length" @click.prevent="filters.role = []" type="button" class="fi-close-button remove-all"></button>
                                                    </div>
                                                    <div class="filter-section">
                                                        <div class="fi-dropdown filter-trigger" data-fi-append-to-body>
                                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-small fi-button-icon">
                                                                <span class="label">Sample IDs</span><i class="far fa-angle-down"></i>
                                                            </button>
                                                            <div class="fi-dropdown-content filter-trigger-content fi-large">
                                                                <div class="search-wrapper">
                                                                    <div class="fi-form-field fi-search"><input type="search" placeholder="Search Sample IDs..." class="fi-form-control"></div>
                                                                </div>
                                                                <div class="select-items check-list">
                                                                    <div class="select-items-inner">
                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="item in all_sample_ids">
                                                                                <a href="#" @click.prevent="toggle_filter('sample_id', item)" class="fi-list-link-wrapper select-item" :class="{'selected': filters.sample_id.includes(item)}">{{ item }}</a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="selected-filters">
                                                            <button v-for="item in filters.sample_id" @click.prevent="toggle_filter('sample_id', item)" type="button" class="fi-badge fi-default">{{ item }}<i class="far fa-times"></i></button>
                                                        </div>
                                                        <button v-if="filters.sample_id.length" @click.prevent="filters.sample_id = []" type="button" class="fi-close-button remove-all"></button>
                                                    </div>
                                                    <div class="filter-section">
                                                        <div class="fi-dropdown filter-trigger" data-fi-append-to-body>
                                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-small fi-button-icon">
                                                                <span class="label">Rates</span><i class="far fa-angle-down"></i>
                                                            </button>
                                                            <div class="fi-dropdown-content filter-trigger-content fi-large">
                                                                <div class="search-wrapper">
                                                                    <div class="fi-form-field fi-search"><input type="search" placeholder="Search Rates..." class="fi-form-control"></div>
                                                                </div>
                                                                <div class="select-items check-list">
                                                                    <div class="select-items-inner">
                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="item in all_rates">
                                                                                <a href="#" @click.prevent="toggle_filter('rate', item)" class="fi-list-link-wrapper select-item" :class="{'selected': filters.rate.includes(item)}">{{ item }}</a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="selected-filters">
                                                            <button v-for="item in filters.rate" @click.prevent="toggle_filter('rate', item)" type="button" class="fi-badge fi-default">{{ item }}<i class="far fa-times"></i></button>
                                                        </div>
                                                        <button v-if="filters.rate.length" @click.prevent="filters.rate = []" type="button" class="fi-close-button remove-all"></button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="actions">
                                                <div class="fi-form fi-form-inline">
                                                    <div class="fi-form-field"><button type="button" :disabled="selected_treatments.length === treatments_filtered_list.length" @click.prevent="select_all_treatments" class="fi-button fi-default fi-small">Select All</button></div>
                                                    <div class="fi-form-field"><button type="button" :disabled="!selected_treatments.length" @click.prevent="unplace_treatments" class="fi-button fi-default fi-small">Unplace</button></div>
                                                    <div class="fi-form-field"><button type="button" :disabled="!selected_treatments.length" data-fi-modal=".generate_plates_modal" class="fi-button fi-default fi-small">Generate Plates from Selected</button></div>
                                                </div>
                                                <div class="fi-form fi-form-inline">
                                                    <div class="fi-form-field"><button type="button" @click.prevent="" class="fi-button fi-default fi-small">Undo</button></div>
                                                    <div class="fi-form-field"><button type="button" @click.prevent="" class="fi-button fi-default fi-small">Redo</button></div>
                                                </div>
                                            </div>
                                            <div class="treatment-counts fi-text-light">
                                                <span v-if="filters_active" class="fi-badge">Showing {{ treatment_result_count }} out of {{ treatments.length }} treatments</span>
                                                <span v-else>Showing {{ treatments.length }} out of {{ treatments.length }} treatments</span>
                                                <span class="separate"></span>
                                                <span>{{ count_placed_treatments() }} placed</span>
                                                <span>{{ treatments.length - count_placed_treatments() }} remaining</span>
                                            </div>
                                        </div>
                                        <div class="treatments-outer">
                                            <div class="treatments-inner">
                                                <div class="treatment-list-container">
                                                    <div class="treatment-item treatments-header">
                                                        <div class="cell id" @click="apply_sort('id')">ID <i v-if="sort.sort_by === 'id'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell place" @click="apply_sort('place')">Plate / Well <i v-if="sort.sort_by === 'place'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell condition-set" @click="apply_sort('condition_set')">Condition Set <i v-if="sort.sort_by === 'condition_set'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell sample-id" @click="apply_sort('sample_id')">Sample ID <i v-if="sort.sort_by === 'sample_id'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell role" @click="apply_sort('role')">Role <i v-if="sort.sort_by === 'role'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell rate" @click="apply_sort('rate')">Rate <i v-if="sort.sort_by === 'rate'" class="fa" :class="sort_class"></i></div>
                                                        <div class="cell replicate" @click="apply_sort('replicate')">Replicate <i v-if="sort.sort_by === 'replicate'" class="fa" :class="sort_class"></i></div>
                                                    </div>
                                                    <drag-select attribute="attr" @change="selection_treatments($event)" class="treatment-list">
                                                        <template v-slot="{ selected }">
                                                            <div v-for="item in treatments_filtered_list"
                                                             :attr="item.id"
                                                             class="treatment-item"
                                                             :class="{'selected': selected_treatments.includes(String(item.id)), 'placed': item.place}">
                                                                <span class="cell id">{{ item.id }}</span>
                                                                <span class="cell place">
                                                                    <span v-if="item.place">
                                                                        <span>{{ item.place.plate_id }}</span>
                                                                        /
                                                                        {{ get_well_location(item.place.well_id).row }}-{{ get_well_location(item.place.well_id).column }}
                                                                    </span>
                                                                    <span v-else>Unplaced</span>
                                                                </span>
                                                                <span class="cell condition-set">{{ item.condition_set }}</span>
                                                                <span class="cell sample-id">{{ item.sample_id }}</span>
                                                                <span class="cell role">{{ role_names[item.role] }}</span>
                                                                <span class="cell rate">{{ item.rate }}</span>
                                                                <span class="cell replicate">{{ item.replicate }}</span>
                                                            </div>
                                                         </template>
                                                    </drag-select>
                                                </div>
                                            </div>
                                            <div class="placement-buttons">
                                                <ul class="fi-list">
                                                    <li v-if="selected_treatments.length < 2 && selected_wells.length < 2">
                                                        <button type="button" :disabled="selected_treatments.length && selected_wells.length && selected_treatments.length !== selected_wells.length" @click.prevent="place_across" class="fi-button fi-default fi-full-width fi-small">Place</button>
                                                    </li>
                                                    <li v-if="selected_treatments.length > 1 || selected_wells.length > 1">
                                                        <button type="button" :disabled="selected_treatments.length > selected_wells.length" @click.prevent="place_across" class="fi-button fi-default fi-full-width fi-small">Place Across</button>
                                                    </li>
                                                    <li v-if="selected_treatments.length > 1 || selected_wells.length > 1">
                                                        <button type="button" :disabled="selected_treatments.length > selected_wells.length" @click.prevent="place_down" class="fi-button fi-default fi-full-width fi-small">Place Down</button>
                                                    </li>
                                                </ul>
                                                <div class="fi-section" :class="{
                                                    'fi-text-danger': selected_treatments.length && selected_wells.length && selected_treatments.length > selected_wells.length,
                                                    'fi-text-success': selected_treatments.length && selected_treatments.length <= selected_wells.length || selected_wells.length && selected_treatments.length <= selected_wells.length
                                                }">
                                                    <div class="fi-section fi-text-center selection-count" v-if="selected_treatments.length" :class="{
                                                        'fi-text-light': !selected_wells.length,
                                                    }">
                                                        <span class="bug-number">{{ selected_treatments.length }}</span>
                                                        treatments selected
                                                    </div>
                                                    <div class="fi-section fi-text-center selection-count" v-if="overall_selected_wells.length" :class="{
                                                        'fi-text-light': !selected_treatments.length,
                                                    }">
                                                        <span class="bug-number">{{ overall_selected_wells.length }}</span>
                                                        wells selected
                                                    </div>

                                                </div>
                                                <div class="fi-section" v-if="selected_treatments.length && selected_wells.length && selected_treatments.length > selected_wells.length">
                                                    <small><strong>Make sure selected wells are more than or equal selected treatments</strong></small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="plates">

                                        <!-- <div class="plates-nav">
                                            <div class="plate-nav-item" v-for="(plate, index) in plates" :class="{'current': index === current_plate_index, 'has-results': plate.well_result_count}">
                                                <div class="plate-info">
                                                    <span class="fi-badge well-result-count" v-if="plate.well_result_count">
                                                        {{ plate.well_result_count }}
                                                        <span v-if="plate.well_result_count > 1">matches</span>
                                                        <span v-else>match</span>
                                                        found
                                                    </span>
                                                    <h5><strong>{{ index + 1 }}: {{ plate.name }}</strong></h5>
                                                    <div class="plate-counts fi-text-light">
                                                        <span>{{ count_placed_wells(plates[index]) }} placed</span>
                                                        <span>{{ plates[index].size - count_placed_wells(plates[index]) }} remaining</span>
                                                    </div>
                                                </div>
                                                <a href="#" @click.prevent="current_plate_index = index; selected_wells = [];" class="plate-nav-item-button"></a>
                                                <button type="button" @click.prevent="delete_plate(index)" class="plate-nav-item-delete fi-close-button"></button>
                                            </div>
                                            <button type="button" @click.prevent="" class="add-plate" data-fi-modal=".add_plate_modal">
                                                <i class="far fa-plus"></i>
                                                Add Plate
                                            </button>
                                        </div> -->

                                        <div class="plates-nav">

                                            <div class="plates-nav-inner">

                                                <draggable class="plate-nav-items" v-model="plates" draggable=".plate-nav-item" @start="start_plate_drag" @end="end_plate_drag">
                                                    <div v-for="(plate, index) in plates" :key="plate.id" class="plate-nav-item" :class="{'current': index === current_plate_index, 'has-results': plate.well_result_count}">
                                                        <div class="plate-info">
                                                            <span class="fi-badge well-result-count" v-if="plate.well_result_count">
                                                                {{ plate.well_result_count }}
                                                                <span v-if="plate.well_result_count > 1">matches</span>
                                                                <span v-else>match</span>
                                                                found
                                                            </span>
                                                            <h5><strong>{{ index + 1 }}: {{ plate.name }}</strong></h5>
                                                            <div class="plate-counts fi-text-light">
                                                                <span>{{ count_placed_wells(plates[index]) }} placed</span>
                                                                <span>{{ plates[index].size - count_placed_wells(plates[index]) }} remaining</span>
                                                            </div>
                                                        </div>
                                                        <a href="#" @click.prevent="current_plate_index = index; selected_wells = [];" class="plate-nav-item-button"></a>
                                                        <button type="button" @click.prevent="delete_plate(index)" class="plate-nav-item-delete fi-close-button"></button>
                                                    </div>
                                                </draggable>

                                                <button type="button" @click.prevent="" class="add-plate" data-fi-modal=".add_plate_modal">
                                                    <i class="far fa-plus"></i>
                                                    Add Plate
                                                </button>

                                            </div>

                                        </div>

                                        <div class="plate-header" v-if="current_plate_index > -1">
                                            <div class="plate-header-info">
                                                <h4 :data-fi-tooltip="current_plate_index + 1 + ': ' + plates[current_plate_index].name" data-fi-delay="250"><strong>{{ current_plate_index + 1 }}: {{ plates[current_plate_index].name }}</strong></h4>
                                                <div v-if="plates[current_plate_index].barcode" class="barcode">{{ plates[current_plate_index].barcode }}</div>
                                                <div class="plate-counts fi-text-light">
                                                    <span>{{ count_placed_wells(plates[current_plate_index]) }} placed</span>
                                                    <span>{{ plates[current_plate_index].size - count_placed_wells(plates[current_plate_index]) }} remaining</span>
                                                </div>
                                                <span class="fi-badge" v-if="plates[current_plate_index].well_result_count">
                                                    {{ plates[current_plate_index].well_result_count }}
                                                    <span v-if="plates[current_plate_index].well_result_count > 1">matches</span>
                                                    <span v-else>match</span>
                                                    found
                                                </span>
                                            </div>
                                            <div class="plate-header-actions">
                                                <div class="fi-form fi-form-inline">
                                                    <!-- <div class="fi-form-field"><button type="button" @click.prevent="selected_wells = [];" class="fi-button fi-default fi-small" v-if="selected_wells.length">Clear Selection</button></div> -->
                                                    <div class="fi-form-field"><button type="button" @click.prevent="set_as_blank" class="fi-button fi-default fi-small" :disabled="!selected_wells.length">Set As Empty</button></div>
                                                    <div class="fi-form-field"><button type="button" @click.prevent="unplace_wells" class="fi-button fi-default fi-small" :disabled="!selected_wells.length">Unplace</button></div>
                                                    <div class="fi-form-field"><button type="button" @click.prevent="clear_plate(current_plate_index)" class="fi-button fi-default fi-small">Clear Plate</button></div>
                                                    <div class="fi-form-field">
                                                        <div class="fi-dropdown fi-opposite plate-dropdown">
                                                            <button type="button" class="fi-dropdown-trigger more-button fi-button fi-default fi-small"><i class="fa fa-ellipsis-v"></i></button>
                                                            <div class="fi-dropdown-content fi-small">
                                                                <ul>
                                                                    <li><a href="#" data-fi-modal=".edit_plate_modal" @click.prevent="open_edit_plate(plates[current_plate_index].id)">Edit Plate</a></li>
                                                                    <li><a href="#" data-fi-modal=".clone_plate_modal">Clone Plate</a></li>
                                                                    <li><a href="#">Save as Standrad Layout</a></li>
                                                                    <li class="fi-divider"></li>
                                                                    <li><a href="#" @click.prevent="delete_plate(current_plate_index)">Delete Plate</a></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="plate-exp-container" v-if="current_plate_index > -1">

                                            <div class="plate-container">

                                                <div class="plate-outer" :class="'size_' + plates[current_plate_index].size">

                                                    <div class="plate-clear-selection" @click="selected_wells = [];"></div>

                                                    <div class="plate-top-bar">

                                                        <div class="plate-corner">
                                                            <div class="plate-select-all" :class="{'selected': selected_wells.length === plates[current_plate_index].wells.length}" @click="select_deselect_all"></div>
                                                        </div>

                                                        <div class="plate-columns">
                                                            <div v-for="(plate_column, index) in plate_sizes[plates[current_plate_index].size].columns" class="plate-column" :class="{'selected': selected_columns.includes(index)}" @click="select_deselect_column(index)">{{ index + 1 }}</div>
                                                        </div>

                                                    </div>

                                                    <div class="plate-inner" :class="{'filter-match': plates[current_plate_index].filter_match}">

                                                        <div class="plate-rows">
                                                            <div v-for="(plate_row, index) in plate_sizes[plates[current_plate_index].size].rows" class="plate-row" :class="{'selected': selected_rows.includes(index)}" @click="select_deselect_row(index)">{{ well_row_letters[index] }}</div>
                                                        </div>

                                                        <drag-select attribute="attr" @change="selection($event)">
                                                            <template v-slot="{ selected }">
                                                                <div v-for="item in plates[current_plate_index].wells"
                                                                 :attr="item.id"
                                                                 @mouseover="well_mouseover(item.id)"
                                                                 @mouseout="well_mouseout(item.id)"
                                                                 class="well"
                                                                  :class="{
                                                                      'filter-match': item.filter_match,
                                                                  }">
                                                                    <div class="well-inner"
                                                                      :class="{
                                                                          'selected': selected_wells.includes(String(item.id)) || temp_selection.includes(String(item.id)),
                                                                          'highlighted': item.highlight,
                                                                      }">
                                                                        <div class="well-content">
                                                                            <span v-if="item.content && item.content !== 'blank'" :style="{ backgroundColor: role_colors[getObjectByKey(treatments, 'id',item.content).role] }">

                                                                            </span>
                                                                            <span v-else-if="item.content && item.content === 'blank'" class="empty"><span class="xl"></span><span class="xr"></span></span>
                                                                            <div class="well-info" v-if="item.content" :data-fi-tooltip="render_tooltip_content(item.id)" :data-fi-offset="tooltip_offset"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                             </template>
                                                        </drag-select>

                                                        <!-- <div class="back-drop"></div> -->

                                                    </div>

                                                </div>

                                            </div>

                                            <div class="color-keys">
                                                <div class="color-keys-inner">
                                                    <div v-if="unset_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'unset', 'active-selection': edit_mode && highlight_by === 'unset'}">
                                                        <div class="color-key-button" @click="highlight('unset')" v-click-outside="reset_highlight_click_outside">
                                                            <span class="circle unset"></span>Not placed ({{ unset_count }})
                                                        </div>
                                                    </div>
                                                    <div v-if="test_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'test_sample', 'active-selection': edit_mode && highlight_by === 'test_sample'}">
                                                        <div class="color-key-button" @click="highlight('test_sample')" v-click-outside="reset_highlight_click_outside">
                                                            <span class="circle" :style="{ backgroundColor: role_colors['test_sample'] }"></span>Test Samples ({{ test_sample_count }})
                                                        </div>
                                                    </div>
                                                    <div v-if="ctrl_w_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_w_sample', 'active-selection': edit_mode && highlight_by === 'ctrl_w_sample'}">
                                                        <div class="color-key-button" @click="highlight('ctrl_w_sample')" v-click-outside="reset_highlight_click_outside">
                                                            <span class="circle" :style="{ backgroundColor: role_colors['ctrl_w_sample'] }"></span>Controls with Samples ({{ ctrl_w_sample_count }})
                                                        </div>
                                                    </div>
                                                    <div v-if="ctrl_wo_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_wo_sample', 'active-selection': edit_mode && highlight_by === 'ctrl_wo_sample'}">
                                                        <div class="color-key-button" @click="highlight('ctrl_wo_sample')" v-click-outside="reset_highlight_click_outside">
                                                            <span class="circle" :style="{ backgroundColor: role_colors['ctrl_wo_sample'] }"></span>Controls without Samples ({{ ctrl_wo_sample_count }})
                                                        </div>
                                                    </div>
                                                    <div v-if="empty_count" class="color-key" :class="{'active': highlight_by === 'empty'}">
                                                        <div class="color-key-button" @click="highlight('empty')" v-click-outside="reset_highlight_click_outside">
                                                            <span class="circle empty"><span class="xl"></span><span class="xr"></span></span>Empty ({{ empty_count }})
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                        <div class="no-items-label empty-template" v-else>
                                            <i class="fal fa-th empty-template-icon"></i>
                                            <div>
                                                No plates added
                                                <div class="empty-template-button">
                                                    <button data-fi-modal=".add_plate_modal" class="fi-button fi-primary fi-small">
                                                        <i class="far fa-plus fi-icon-margin"></i>Add Plate
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="add_plate_modal fi-modal fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="fi-modal-header">
                            <button type="button" class="fi-close-button fi-close-modal"></button>
                            <h3>Add Plate</h3>
                        </div>

                        <form @submit.prevent="submit_add_plate">

                            <div class="fi-modal-body">

                                <div class="fi-form">
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Name</label>
                                        <input type="text" class="fi-form-control" v-model="add_plate_data.name" data-fi-focus-start />
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Size</label>
                                        <div class="custom-dropdown">
                                            <select class="fi-form-control" v-model="add_plate_data.size">
                                                <option value="0">Please select...</option>
                                                <option v-for="size in plate_sizes" :value="size.name">{{ size.name }} ({{ size.columns }}x{{ size.rows }})</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Barcode (Optional)</label>
                                        <input type="text" class="fi-form-control" v-model="add_plate_data.barcode" maxlength="10" :class="{'error': add_plate_data.barcode != '' && !check_number(add_plate_data.barcode)}" />
                                        <div class="fi-hint"><span>10 digits</span></div>
                                    </div>
                                </div>

                            </div>

                            <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                <button type="submit" class="fi-button fi-primary" :disabled="!add_plate_data.name || add_plate_data.size == 0 || (add_plate_data.barcode != '' && !check_number(add_plate_data.barcode)) || (add_plate_data.barcode != '' && add_plate_data.barcode.toString().length < 10)">Add Plate</button>
                            </div>

                        </form>

                    </div>
                </div>
            </div>
        </div>

        <div class="edit_plate_modal fi-modal fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="fi-modal-header">
                            <button type="button" class="fi-close-button fi-close-modal"></button>
                            <h3>Edit Plate</h3>
                        </div>

                        <form @submit.prevent="submit_edit_plate">

                            <div class="fi-modal-body">

                                <div class="fi-form">
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Plate Name</label>
                                        <input type="text" class="fi-form-control" v-model="edit_plate_data.name" data-fi-focus-start />
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Plate Size</label>
                                        <select class="fi-form-control" v-model="edit_plate_data.size">
                                            <option value="0">Please select...</option>
                                            <option v-for="size in plate_sizes" :value="size.name">{{ size.name }} ({{ size.columns }}x{{ size.rows }})</option>
                                        </select>
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Barcode (Optional)</label>
                                        <input type="text" class="fi-form-control" v-model="edit_plate_data.barcode" maxlength="10" :class="{'error': edit_plate_data.barcode != '' && !check_number(edit_plate_data.barcode)}" />
                                        <div class="fi-hint"><span>10 digits</span></div>
                                    </div>
                                </div>

                            </div>

                            <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                <button type="submit" class="fi-button fi-primary" :disabled="!edit_plate_data.name || edit_plate_data.size == 0 || (edit_plate_data.barcode != '' && !check_number(edit_plate_data.barcode)) || (edit_plate_data.barcode != '' && edit_plate_data.barcode.toString().length < 10)">Apply Changes</button>
                            </div>

                        </form>

                    </div>
                </div>
            </div>
        </div>

        <div class="generate_plates_modal fi-modal fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="fi-modal-header">
                            <button type="button" class="fi-close-button fi-close-modal"></button>
                            <h3>Generate Plates</h3>
                        </div>

                        <form @submit.prevent="">

                            <div class="fi-modal-body">

                                <div class="fi-form">
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Plate Layout</label>
                                        <div class="fi-dropdown fi-full-width choose-layout">
                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-full-width">
                                                <span class="fi-dropdown-title">
                                                    <span v-if="generate_plates_data.plate_layout.name">{{ generate_plates_data.plate_layout.name }}</span>
                                                    <span v-else>Pleae select a layout...</span>
                                                </span>
                                                <i class="far fa-angle-down"></i>
                                            </button>
                                            <div class="fi-dropdown-content fi-full-width play-layout-selector">
                                                <div class="search-wrapper">
                                                    <div class="fi-form-field fi-search"><input type="search" class="fi-form-control" placeholder="Search Layouts..."></div>
                                                </div>
                                                <div class="filter">
                                                    <div class="button-group">
                                                        <button type="button" @click.prevent="layouts_filter.main_view = 'my_layouts'" class="fi-button fi-small fi-width-small-6" :class="{'fi-primary': layouts_filter.main_view === 'my_layouts', 'fi-default': layouts_filter.main_view !== 'my_layouts',}">My Layouts</button>
                                                        <button type="button" @click.prevent="layouts_filter.main_view = 'my_platforms'" class="fi-button fi-small fi-width-small-6" :class="{'fi-primary': layouts_filter.main_view === 'my_platforms', 'fi-default': layouts_filter.main_view !== 'my_platforms',}">My Platforms</button>
                                                        <button type="button" @click.prevent="layouts_filter.main_view = 'all'" class="fi-button fi-small fi-width-small-6" :class="{'fi-primary': layouts_filter.main_view === 'all', 'fi-default': layouts_filter.main_view !== 'all',}">All</button>
                                                    </div>
                                                </div>
                                                <!-- <div class="filters-multiple fi-panel">
                                                    <div class="filter-section">
                                                        <div class="fi-dropdown filter-trigger" data-fi-append-to-body>
                                                            <button type="button" class="fi-dropdown-trigger fi-button fi-default fi-small fi-button-icon">
                                                                <span class="label">Sizes</span><i class="far fa-angle-down"></i>
                                                            </button>
                                                            <div class="fi-dropdown-content filter-trigger-content fi-large">
                                                                <div class="search-wrapper">
                                                                    <div class="fi-form-field fi-search"><input type="search" placeholder="Search Sizes..." class="fi-form-control" /></div>
                                                                </div>
                                                                <div class="select-items check-list">
                                                                    <div class="select-items-inner">
                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="size in plate_sizes">
                                                                                <a href="#" @click.prevent="toggle_layouts_filter('sizes', size.name)" class="fi-list-link-wrapper select-item" :class="{'selected': layouts_filter.sizes.includes(size.name)}">{{ size.name }} ({{ size.columns }}x{{ size.rows }})</a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="selected-filters">
                                                            <button type="button" v-for="item in layouts_filter.sizes" @click.prevent="toggle_layouts_filter('sizes', item)" class="fi-badge fi-default vue-click-bug">
                                                                {{ plate_sizes[item].name }} ({{ plate_sizes[item].columns }}x{{ plate_sizes[item].rows }})<i class="far fa-times"></i>
                                                            </button>
                                                        </div>
                                                        <button v-show="layouts_filter.sizes.length" @click="layouts_filter.sizes = []" class="fi-close-button remove-all"></button>
                                                    </div>
                                                </div> -->
                                                <div class="fi-form fi-form-inline toggle-thumbs">
                                                    <div class="fi-form-field">
                                                        <span class="fi-form-label">Show thumbnails for</span>
                                                        <div class="custom-dropdown fi-small value">
                                                            <select class="fi-form-control fi-small">
                                                                <option value="roles">Roles</option>
                                                                <option value="test_sample">Test Samples</option>
                                                                <option value="ctrl_w_sample">Control with Sample</option>
                                                                <option value="ctrl_wo_sample">Control without Sample</option>
                                                                <option value="rates">Rates</option>
                                                                <option value="condition_sets">Condition Sets</option>
                                                                <option value="replicates">Replicates</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <ul class="fi-list fi-list-line fi-no-spacing fi-no-margin">
                                                    <li v-for="plate_layout in plate_layouts" :class="{'active': generate_plates_data.plate_layout.id == plate_layout.id}">
                                                        <a href="#" @click.prevent="choose_layout(plate_layout.id)">
                                                            <div class="blurb layout-blurb">
                                                                <div class="blurb-media"><div class="thumb"></div></div>
                                                                <div class="blurb-content">
                                                                    <h4><strong>{{ plate_layout.name }}</strong></h4>
                                                                    <div class="meta fi-text-light">
                                                                        <span>{{ plate_sizes[plate_layout.size].name }} ({{plate_sizes[plate_layout.size].columns}}x{{plate_sizes[plate_layout.size].rows}})</span>
                                                                        <span>{{ getObjectByKey(platforms, 'id', plate_layout.platform).name }}</span>
                                                                        <span>BSD</span>
                                                                    </div>
                                                                    <div class="meta fi-text-light">
                                                                        <span>Samples/Controls (28)</span>
                                                                        <span>Rates (4)</span>
                                                                        <span>Condition Sets (16)</span>
                                                                        <span>Replicates (2)</span>
                                                                    </div>
                                                                    <div class="meta fi-text-light">
                                                                        <span data-fi-tooltip="
                                                                        <ul class='fi-list well-info-content'>
                                                                            <li>Rates (4)</li>
                                                                            <li>Condition Sets (16)</li>
                                                                            <li>Replicates (2)</li>
                                                                        </ul>
                                                                        ">Test Samples (16)</span>
                                                                        <span data-fi-tooltip="
                                                                        <ul class='fi-list well-info-content'>
                                                                            <li>Rates (2)</li>
                                                                            <li>Condition Sets (12)</li>
                                                                            <li>Replicates (2)</li>
                                                                        </ul>
                                                                        ">Controls with Samples (8)</span>
                                                                        <span data-fi-tooltip="
                                                                        <ul class='fi-list well-info-content'>
                                                                            <li>Rates (2)</li>
                                                                            <li>Condition Sets (4)</li>
                                                                            <li>Replicates (2)</li>
                                                                        </ul>
                                                                        ">Controls without Samples (4)</span>
                                                                    </div>
                                                                    <div class="method-default" v-if="plate_layout.method_default">
                                                                        <div class="tags">
                                                                            <span class="fi-badge">Method Default</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </a>
                                                        <button class="fi-button fi-button-icon info-button" data-fi-modal=".edit-modal"><i class="far fa-info-circle"></i></button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="fi-form-field" v-if="generate_plates_data.plate_layout.name">
                                        <div class="fi-panel special">
                                            <strong>3 plates</strong> will be generated
                                        </div>
                                    </div>
                                    <div class="fi-form-field" v-if="generate_plates_data.plate_layout.name">
                                        <label class="fi-form-label">Plate Names Prefix</label>
                                        <input type="text" class="fi-form-control" v-model="generate_plates_data.prefix" />
                                    </div>

                                </div>

                            </div>

                            <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                <button type="submit" class="fi-button fi-primary fi-close-modal" :disabled="!generate_plates_data.plate_layout.name">Generate Plates</button>
                            </div>

                        </form>

                    </div>
                </div>
            </div>
        </div>

        <div class="generate_using_defaults_modal fi-modal fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="fi-modal-header">
                            <button type="button" class="fi-close-button fi-close-modal"></button>
                            <h3>Generate Plates for All Methods</h3>
                        </div>

                        <form @submit.prevent="">

                            <div class="fi-modal-body">

                                <div>

                                    <p v-if="plates.length">This process will delete all the plates under the methods that have default layouts and generate new ones using these layouts.</p>
                                    <p v-else>This process will generate plates under all the methods that have default layouts.</p>

                                    <p>Are you sure you want to proceed?</p>

                                </div>

                            </div>

                            <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                <button type="submit" class="fi-button fi-primary fi-close-modal">Yes, I'm Sure</button>
                            </div>

                        </form>

                    </div>
                </div>
            </div>
        </div>

        <div class="clone_plate_modal fi-modal fi-no-click-close fi-large">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="wizard-steps">
                            <div class="step" v-if="clone_step === 'select_parameter'">

                                <div class="fi-modal-header">
                                    <button type="button" class="fi-close-button fi-close-modal"></button>
                                    <h3>Clone Plate</h3>
                                </div>

                                <div class="fi-modal-body">

                                    <p><strong>Please select a paramter to change</strong></p>

                                    <div class="fi-panel block-links">
                                        <ul class="fi-list fi-list-line fi-no-spacing">
                                            <li>
                                                <a href="#" class="fi-list-link-wrapper" @click.prevent="clone_step = 'sample_ids'">
                                                    <span>Sample IDs</span>
                                                    <i class="far fa-chevron-right more-chevron"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="fi-list-link-wrapper" @click.prevent="clone_step = 'condition_sets'">
                                                    <span>Condition Sets</span>
                                                    <i class="far fa-chevron-right more-chevron"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="fi-list-link-wrapper" @click.prevent="clone_step = 'rates'">
                                                    <span>Rates</span>
                                                    <i class="far fa-chevron-right more-chevron"></i>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="fi-list-link-wrapper" @click.prevent="clone_step = 'replicates'">
                                                    <span>Replicates</span>
                                                    <i class="far fa-chevron-right more-chevron"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>

                                </div>

                                <div class="fi-modal-footer fi-buttons-container">
                                    <button type="button" class="fi-button fi-default fi-close-modal">Cancel</button>
                                </div>

                            </div>

                            <div class="step" v-if="clone_step === 'sample_ids'">

                                <div class="fi-modal-header">
                                    <button type="button" class="fi-close-button fi-close-modal"></button>
                                    <h3>Clone Plate</h3>
                                </div>

                                <div class="fi-modal-body">

                                    <div>
                                        <h4><i class="far fa-exclamation-triangle  fi-text-danger fi-icon-margin"></i><strong>No treatments found</strong></h4>
                                        <p>There are no available treatments with different Sample IDs matching the ones in this plate.</p>
                                    </div>

                                </div>

                                <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                    <button type="button" class="fi-button fi-default fi-float-left fi-no-margin" @click.prevent="clone_step = 'select_parameter'">Back</button>
                                    <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                </div>

                            </div>

                            <div class="step" v-if="clone_step === 'condition_sets'">

                                <div class="fi-modal-header">
                                    <button type="button" class="fi-close-button fi-close-modal"></button>
                                    <h3>Clone Plate</h3>
                                </div>

                                <div class="fi-modal-body">

                                    <div style="display: none;">
                                        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.</p>
                                    </div>

                                    <hr style="display: none;" />

                                    <div class="small-spacing">

                                        <div class="fi-row">
                                            <div class="fi-column fi-width-small-4">
                                                <p><strong>Condition sets in original plate ({{ clone_original_condition_sets.length }})</strong></p>
                                                <div class="fi-panel fi-no-padding scroll-list">
                                                    <div class="select-items original-values">

                                                        <div class="select-items-inner">

                                                            <ul class="fi-list fi-list-line fi-no-spacing">
                                                                <li v-for="condition_set in clone_original_condition_sets">
                                                                    <span class="select-item">{{ condition_set }}</span>
                                                                </li>
                                                            </ul>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="fi-column fi-width-small-8">
                                                <p><strong>Available condition sets from unplaced treatments ({{ clone_available_condition_sets.length }})</strong></p>
                                                <div class="fi-panel fi-no-padding">
                                                    <div class="add-users-container">

                                                        <div class="search-users">
                                                            <div class="fi-form-field">
                                                                <div class="fi-search">
                                                                    <input type="search" class="fi-form-control search-control" placeholder="Search available condition sets...">
                                                                    <input type="submit" value="">
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="browse-users">

                                                            <div class="panel-alt">

                                                                <div class="panel-alt-header">
                                                                    <h5 class="panel-alt-title">
                                                                        <span v-if="clone_original_condition_sets.length > 1">Select up to {{ clone_original_condition_sets.length }} condition sets</span>
                                                                        <span v-else>Select 1 condition set</span>
                                                                    </h5>
                                                                </div>

                                                                <div class="select-items check-list">

                                                                    <div class="select-items-inner">

                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="condition_set in clone_available_condition_sets">
                                                                                <a href="#" @click.prevent="toggle_clone_value('condition_sets', condition_set)" class="fi-list-link-wrapper select-item" :class="{'selected': clone_selected_condition_sets.includes(condition_set)}">
                                                                                    {{ condition_set }}
                                                                                </a>
                                                                                <div class="disabled" v-if="!clone_selected_condition_sets.includes(condition_set) && clone_selected_condition_sets.length === clone_original_condition_sets.length" data-fi-tooltip="Your selection has reached the limit" data-fi-position="top-left"></div>
                                                                            </li>
                                                                        </ul>

                                                                    </div>

                                                                </div>

                                                            </div>

                                                        </div>

                                                        <div class="selected-users">

                                                            <div class="panel-alt">

                                                                <div class="panel-alt-header">
                                                                    <button type="button" v-show="clone_selected_condition_sets.length" @click.prevent="clone_selected_condition_sets = []" class="fi-button fi-button-icon action-button remove-all"><span>Remove all</span></button>

                                                                    <h5 class="panel-alt-title">
                                                                        Selected (<span class="selected-count">{{ clone_selected_condition_sets.length }}</span>)
                                                                    </h5>
                                                                </div>

                                                                <div class="selected-items">

                                                                    <div class="selected-items-inner">

                                                                        <ul class="fi-list fi-list-line fi-no-spacing">
                                                                            <li v-for="condition_set in clone_selected_condition_sets">
                                                                                <div class="selected-member">
                                                                                    {{ condition_set }}
                                                                                    <button type="btton" @click.prevent="toggle_clone_value('condition_sets', condition_set)" class="fi-close-button remove-item"></button>
                                                                                </div>
                                                                            </li>
                                                                        </ul>

                                                                    </div>

                                                                </div>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>

                                <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                    <button type="button" class="fi-button fi-default fi-float-left fi-no-margin" @click.prevent="clone_step = 'select_parameter'">Back</button>
                                    <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                    <button type="button" class="fi-button fi-primary fi-close-modal" @click.prevent="" :disabled="!clone_selected_condition_sets.length">Clone Plate</button>
                                </div>

                            </div>

                            <div class="step" v-if="clone_step === 'rates'">

                                <div class="fi-modal-header">
                                    <button type="button" class="fi-close-button fi-close-modal"></button>
                                    <h3>Clone Plate</h3>
                                </div>

                                <div class="fi-modal-body">

                                    <div style="display: none;">
                                        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.</p>
                                    </div>

                                    <hr style="display: none;" />

                                    <div class="small-spacing">

                                        <div class="fi-row">
                                            <div class="fi-column fi-width-small-4">
                                                <p><strong>Rates in original plate ({{ clone_original_rates.length }})</strong></p>
                                                <div class="fi-panel fi-no-padding scroll-list">
                                                    <div class="select-items original-values">

                                                        <div class="select-items-inner">

                                                            <ul class="fi-list fi-list-line fi-no-spacing">
                                                                <li v-for="rate in clone_original_rates">
                                                                    <span class="select-item">{{ rate }}</span>
                                                                </li>
                                                            </ul>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="fi-column fi-width-small-8">
                                                <p><strong>Available rates from unplaced treatments ({{ clone_available_rates.length }})</strong></p>
                                                <div class="fi-panel fi-no-padding">
                                                    <div class="add-users-container">

                                                        <div class="search-users">
                                                            <div class="fi-form-field">
                                                                <div class="fi-search">
                                                                    <input type="search" class="fi-form-control search-control" placeholder="Search available rates..." data-suggest="">
                                                                    <input type="submit" value="">
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="browse-users">

                                                            <div class="panel-alt">

                                                                <div class="panel-alt-header">
                                                                    <h5 class="panel-alt-title">
                                                                        <span v-if="clone_original_rates.length > 1">Select up to {{ clone_original_rates.length }} rates</span>
                                                                        <span v-else>Select 1 rate</span>
                                                                    </h5>
                                                                </div>

                                                                <div class="select-items check-list">

                                                                    <div class="select-items-inner">

                                                                        <ul class="fi-list fi-no-spacing">
                                                                            <li v-for="rate in clone_available_rates">
                                                                                <a href="#" @click.prevent="toggle_clone_value('rates', rate)" class="fi-list-link-wrapper select-item" :class="{'selected': clone_selected_rates.includes(rate)}">
                                                                                    {{ rate }}
                                                                                </a>
                                                                                <div class="disabled" v-if="!clone_selected_rates.includes(rate) && clone_selected_rates.length === clone_original_rates.length" data-fi-tooltip="Your selection has reached the limit" data-fi-position="top-left"></div>
                                                                            </li>
                                                                        </ul>

                                                                    </div>

                                                                </div>

                                                            </div>

                                                        </div>

                                                        <div class="selected-users">

                                                            <div class="panel-alt">

                                                                <div class="panel-alt-header">
                                                                    <button type="button" v-show="clone_selected_rates.length" @click.prevent="clone_selected_rates = []" class="fi-button fi-button-icon action-button remove-all"><span>Remove all</span></button>

                                                                    <h5 class="panel-alt-title">
                                                                        Selected (<span class="selected-count">{{ clone_selected_rates.length }}</span>)
                                                                    </h5>
                                                                </div>

                                                                <div class="selected-items">

                                                                    <div class="selected-items-inner">

                                                                        <ul class="fi-list fi-list-line fi-no-spacing">
                                                                            <li v-for="rate in clone_selected_rates">
                                                                                <div class="selected-member">
                                                                                    {{ rate }}
                                                                                    <button type="btton" @click.prevent="toggle_clone_value('rates', rate)" class="fi-close-button remove-item"></button>
                                                                                </div>
                                                                            </li>
                                                                        </ul>

                                                                    </div>

                                                                </div>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>

                                <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                    <button type="button" class="fi-button fi-default fi-float-left fi-no-margin" @click.prevent="clone_step = 'select_parameter'">Back</button>
                                    <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                    <button type="button" class="fi-button fi-primary fi-close-modal" @click.prevent="" :disabled="!clone_selected_rates.length">Clone Plate</button>
                                </div>

                            </div>

                            <div class="step" v-if="clone_step === 'replicates'">

                                <div class="fi-modal-header">
                                    <button type="button" class="fi-close-button fi-close-modal"></button>
                                    <h3>Clone Plate</h3>
                                </div>

                                <div class="fi-modal-body">

                                    <div>
                                        <h4><i class="far fa-exclamation-triangle fi-text-warning fi-icon-margin"></i><strong>Some replicates are unavailable</strong></h4>
                                        <p>Only <strong>76</strong> out of the <strong>82</strong> treatments in the original plate have available replicates that can be used in the cloned plate.</p>
                                        <p>If you choose to proceed, the wells for the unavailable replicates will be set as Empty.</p>
                                    </div>

                                    <div style="display: none;">
                                        <h4><strong>All replicates available</strong></h4>
                                        <p>All the treatments in the original plate have available replicates that can be used in the cloned plate.</p>
                                        <p>Click <strong>Clone Plate</strong> to complete the cloning process.</p>
                                    </div>

                                </div>

                                <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                    <button type="button" class="fi-button fi-default fi-float-left fi-no-margin" @click.prevent="clone_step = 'select_parameter'">Back</button>
                                    <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                    <button type="button" class="fi-button fi-primary fi-close-modal" @click.prevent="" :disabled="clone_selected_replicates > clone_original_replicates || clone_selected_replicates == 0">Clone Plate</button>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <div id="create_app" v-cloak>

        <div class="create-modal edit-modal fi-modal fi-full-width fi-full-height fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div><button type="button" class="fi-close-button circle-close fi-close-modal"></button></div>

                        <div class="fi-modal-body fi-no-padding">

                            <div class="fi-modal-body-inner">

                                <div class="plate-layout-container">

                                    <div class="plates">

                                        <div class="fi-tabs fi-alt header-tabs">

                                            <ul>
                                                <li :class="{'fi-tab-active': active_tab === 'basic_info'}">
                                                    <button @click.prevent="active_tab = 'basic_info'; trigger_change_tab();" type="button" class="fi-tab-button"><i class="far fa-exclamation-circle fi-icon-margin"></i>Basic Info</button>
                                                </li>
                                                <li :class="{'fi-tab-active': active_tab === 'design'}">
                                                    <button @click.prevent="active_tab = 'design'; trigger_change_tab();" type="button" class="fi-tab-button"><i class="far fa-magic fi-icon-margin"></i>Design</button>
                                                </li>
                                            </ul>

                                            <div class="top-right-buttons fi-form fi-form-inline large-spacing">

                                                <div v-if="edit_mode" class="fi-form-field fi-text-light">
                                                    <span>{{ count_placed_wells }} completed</span>
                                                </div>

                                                <div v-if="edit_mode" class="fi-form-field fi-text-light">
                                                    <span>{{ layout.size - count_placed_wells }} remaining</span>
                                                </div>

                                                <div v-if="edit_mode" class="fi-form-field main-actions fi-buttons-container fi-text-right">
                                                    <button type="button" v-if="saved_before" @click.prevent="edit_mode = false" class="fi-button fi-default fi-small">Cancel</button>
                                                    <button type="button" v-if="!saved_before" class="fi-button fi-primary fi-small" @click.prevent="save_layout">Create Layout</button>
                                                    <button type="button" v-else class="fi-button fi-primary fi-small" @click.prevent="save_layout">Save Changes</button>
                                                </div>
                                                <div v-else class="fi-form-field main-actions fi-buttons-container fi-text-right">
                                                    <button type="button" class="fi-button fi-primary fi-small" @click.prevent="edit_mode = true">Edit Layout</button>
                                                </div>

                                            </div>

                                        </div>

                                        <div class="basic-info-tab-content tab-content" :class="{'active': active_tab === 'basic_info'}">
                                            <div class="basic-info-form">
                                                <div class="fi-form">
                                                    <div class="fi-row fi-grid-margin">
                                                        <div class="fi-column fi-width-small-6">
                                                            <div class="fi-form-field">
                                                                <span class="fi-form-label">Name <span class="fi-text-danger">*</span></span>
                                                                <input type="text" v-model="layout.name" class="fi-form-control fi-large" :class="{'error': !layout.name}" :readonly="!edit_mode" />
                                                            </div>
                                                        </div>
                                                        <div class="fi-column fi-width-small-6">
                                                            <div class="fi-form-field">
                                                                <span class="fi-form-label">Size <span class="fi-text-danger">*</span></span>
                                                                <div v-if="edit_mode" class="custom-dropdown fi-large">
                                                                    <select class="fi-form-control" v-model="layout.size" :class="{'placeholder': layout.size == 0}">
                                                                        <option v-for="size in plate_sizes" :value="size.name">{{ size.name }} ({{ size.columns }}x{{ size.rows }})</option>
                                                                    </select>
                                                                </div>
                                                                <input v-else type="text" :value="layout.size" class="fi-form-control fi-large" readonly="readonly" />
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="fi-row">
                                                        <div class="fi-column fi-width-small-6">
                                                            <div class="fi-form-field">
                                                                <span class="fi-form-label">Platform <span class="fi-text-danger">*</span></span>
                                                                <div v-if="edit_mode" class="custom-dropdown fi-large">
                                                                    <select class="fi-form-control" v-model="layout.platform" :class="{'placeholder': layout.platform == 0}">
                                                                        <option value="0">Please select...</option>
                                                                        <option v-for="platform in platforms" :value="platform.id">{{ platform.name }}</option>
                                                                    </select>
                                                                </div>
                                                                <input v-else type="text" :value="getObjectByKey(platforms, 'id', layout.platform).name" class="fi-form-control fi-large" readonly="readonly" />
                                                            </div>
                                                        </div>
                                                        <div class="fi-column fi-width-small-6">
                                                            <div class="fi-form-field">
                                                                <span class="fi-form-label">Dispensary <span class="fi-text-danger">*</span></span>
                                                                <div v-if="edit_mode" class="custom-dropdown fi-large">
                                                                    <select class="fi-form-control"  v-model="layout.dispensary" :class="{'placeholder': layout.dispensary == 0}">
                                                                        <option value="0">Please select...</option>
                                                                        <option value="BSD">BSD</option>
                                                                        <option value="BSD">JHD</option>
                                                                    </select>
                                                                </div>
                                                                <input v-else type="text" :value="layout.dispensary" class="fi-form-control fi-large" readonly="readonly" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="design-tab-content tab-content" :class="{'active': active_tab === 'design'}">

                                            <div class="layout-mode">
                                                <div class="fi-form fi-form-inline large-spacing main">
                                                    <div class="fi-form-field">
                                                        <span class="fi-form-label">Mode</span>
                                                        <div class="button-group">
                                                            <button type="button" @click.prevent="layout_mode = 'roles'; check_selection();" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'roles', 'fi-primary': layout_mode === 'roles'}">Roles</button>
                                                            <button type="button" @click.prevent="layout_mode = 'test_samples'; check_selection();" :disabled="!test_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'test_samples', 'fi-primary': layout_mode === 'test_samples'}">Test Samples</button>
                                                            <button type="button" @click.prevent="layout_mode = 'ctrl_w_samples'; check_selection();" :disabled="!ctrl_w_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'ctrl_w_samples', 'fi-primary': layout_mode === 'ctrl_w_samples'}">Controls with Samples</button>
                                                            <button type="button" @click.prevent="layout_mode = 'ctrl_wo_samples'; check_selection();" :disabled="!ctrl_wo_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'ctrl_wo_samples', 'fi-primary': layout_mode === 'ctrl_wo_samples'}">Controls without Samples</button>
                                                        </div>
                                                        <div class="button-group">
                                                            <button type="button" @click.prevent="layout_mode = 'rates'; check_selection();" :disabled="!test_sample_count && !ctrl_w_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'rates', 'fi-primary': layout_mode === 'rates'}">Rates</button>
                                                            <button type="button" @click.prevent="layout_mode = 'condition_sets'; check_selection();" :disabled="!test_sample_count && !ctrl_w_sample_count && !ctrl_wo_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'condition_sets', 'fi-primary': layout_mode === 'condition_sets'}">Condition Sets</button>
                                                            <button type="button" @click.prevent="layout_mode = 'replicates'; check_selection();" :disabled="!test_sample_count && !ctrl_w_sample_count && !ctrl_wo_sample_count" class="fi-button fi-small" :class="{'fi-default': layout_mode !== 'replicates', 'fi-primary': layout_mode === 'replicates'}">Replicates</button>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div v-if="edit_mode"  class="fi-form fi-form-inline large-spacing">

                                                    <div class="fi-form-fields fi-buttons-container fi-text-right">
                                                        <button type="button" @click.prevent="" class="fi-button fi-default fi-small fi-no-margin">Undo</button>
                                                        <button type="button" @click.prevent="" class="fi-button fi-default fi-small">Redo</button>
                                                        <button type="button" @click.prevent="clear_plate" class="fi-button fi-default fi-small">Clear Layout</button>
                                                    </div>

                                                </div>
                                            </div>

                                            <div class="controls">
                                                <div class="fi-form fi-form-inline large-spacing main">
                                                    <div class="fi-form-field" v-if="!edit_mode">
                                                        <div class="fi-panel special alert">
                                                            <i class="fa fa-info-circle fi-icon-margin"></i><div>You are currently in View Mode</div>
                                                            <button type="button" @click.prevent="edit_mode = true" class="fi-button fi-default fi-small">Edit Layout</button>
                                                        </div>
                                                    </div>

                                                    <div class="fi-form-field" v-if="selected_wells.length">

                                                        <div class="fi-form-field" v-if="layout_mode === 'roles'">
                                                            <span class="fi-form-label">Role</span>
                                                            <div class="custom-dropdown fi-small value">
                                                                <select class="fi-form-control fi-small" v-model="role_value">
                                                                    <option value="test_sample">Test Sample</option>
                                                                    <option value="ctrl_w_sample">Control with Sample</option>
                                                                    <option value="ctrl_wo_sample">Control without Sample</option>
                                                                    <option value="empty">Empty</option>
                                                                </select>
                                                            </div>
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'test_samples' && selected_wells.length">
                                                            <span class="fi-form-label">Test Sample #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="test_sample_value" :class="{'error': test_sample_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="test_sample_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'ctrl_w_samples' && selected_wells.length">
                                                            <span class="fi-form-label">Control with Sample #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="ctrl_w_sample_value" :class="{'error': ctrl_w_sample_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="ctrl_w_sample_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'ctrl_wo_samples' && selected_wells.length">
                                                            <span class="fi-form-label">Control without Sample #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="ctrl_wo_sample_value" :class="{'error': ctrl_wo_sample_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="ctrl_wo_sample_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'rates' && selected_wells.length">
                                                            <span class="fi-form-label">Rate #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="rate_value" :class="{'error': rate_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="rate_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'condition_sets' && selected_wells.length">
                                                            <span class="fi-form-label">Condition Set #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="condition_set_value" :class="{'error': condition_set_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="condition_set_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field" v-if="layout_mode === 'replicates' && selected_wells.length">
                                                            <span class="fi-form-label">Replicate #</span>
                                                            <input type="number" class="fi-form-control fi-small value" value="1" min="1" v-model="replicate_value" :class="{'error': replicate_value < 1}" />
                                                            <button type="button" @click.prevent="set" class="fi-button fi-default fi-small" :disabled="replicate_value < 1">Set</button>
                                                        </div>

                                                        <div class="fi-form-field separator" v-if="layout_mode !== 'roles'"></div>

                                                        <div class="fi-form-field" v-if="layout_mode !== 'roles'">
                                                            <button type="button" data-fi-modal=".auto_set_modal" @click.prevent="open_auto_set" class="fi-button fi-default fi-small">Auto Set</button>
                                                        </div>

                                                        <div class="fi-form-field separator"></div>

                                                        <div class="fi-form-field">
                                                            <button type="button" @click.prevent="unset" class="fi-button fi-default fi-small">Unset</button>
                                                        </div>

                                                    </div>

                                                    <div class="fi-form-field" v-else>
                                                        <span class="fi-text-light">No wells selected</span>
                                                    </div>

                                                </div>
                                            </div>

                                            <div class="create-container">

                                                <div class="plate-container create" :class="{'view-mode': !edit_mode}">

                                                    <div class="plate-outer" :class="'size_' + layout.size">

                                                        <div class="plate-clear-selection" @click="selected_wells = [];"></div>

                                                        <div class="plate-top-bar">

                                                            <div class="plate-corner">
                                                                <div class="plate-select-all" :class="{'selected': all_wells_selected}" @click="select_deselect_all"></div>
                                                            </div>

                                                            <div class="plate-columns">
                                                                <div v-for="(plate_column, index) in plate_sizes[layout.size].columns" class="plate-column" :class="{'selected': selected_columns.includes(index)}" @click="select_deselect_column(index)">{{ index + 1 }}</div>
                                                            </div>

                                                        </div>

                                                        <div class="plate-inner" :class="{'filter-match': layout.filter_match}">

                                                            <div class="plate-rows">
                                                                <div v-for="(plate_row, index) in plate_sizes[layout.size].rows" class="plate-row" :class="{'selected': selected_rows.includes(index)}" @click="select_deselect_row(index)">{{ well_row_letters[index] }}</div>
                                                            </div>

                                                            <drag-select attribute="attr" @change="selection($event)" v-if="edit_mode">
                                                                <template v-slot="{ selected }">
                                                                    <div v-for="item in layout.wells"
                                                                     :attr="item.id"
                                                                     @mouseover="well_mouseover(item.id)"
                                                                     @mouseout="well_mouseout(item.id)"
                                                                     class="well"
                                                                     :class="{
                                                                         'disabled': item.disable
                                                                     }">
                                                                        <div class="well-inner"
                                                                        :class="{
                                                                            'selected': selected_wells.includes(String(item.id)) || temp_selection.includes(String(item.id)),
                                                                            'role-set': item.content.role,
                                                                            'highlighted': item.highlight
                                                                           }">
                                                                            <div v-if="item.content" class="well-content">
                                                                                <span v-if="item.content.role === 'empty'" class="empty"><span class="xl"></span><span class="xr"></span></span>
                                                                                <span v-else-if="layout_mode === 'roles' && item.content.role
                                                                                ||
                                                                                (
                                                                                    layout_mode === 'test_samples' && item.content.role !== 'test_sample'
                                                                                    ||
                                                                                    layout_mode === 'ctrl_w_samples' && item.content.role !== 'ctrl_w_sample'
                                                                                    ||
                                                                                    layout_mode === 'ctrl_wo_samples' && item.content.role !== 'ctrl_wo_sample'
                                                                                    ||
                                                                                    layout_mode === 'rates' && item.content.role === 'ctrl_wo_sample'
                                                                                )
                                                                                " :style="{ backgroundColor: role_colors[item.content.role] }"></span>
                                                                                <span v-else-if="layout_mode === 'test_samples' && item.content.test_sample" :style="{ backgroundColor: getObjectByKey(test_samples, 'id', item.content.test_sample).color }"></span>
                                                                                <span v-else-if="layout_mode === 'ctrl_w_samples' && item.content.ctrl_w_sample" :style="{ backgroundColor: getObjectByKey(ctrl_w_samples, 'id', item.content.ctrl_w_sample).color }"></span>
                                                                                <span v-else-if="layout_mode === 'ctrl_wo_samples' && item.content.ctrl_wo_sample" :style="{ backgroundColor: getObjectByKey(ctrl_wo_samples, 'id', item.content.ctrl_wo_sample).color }"></span>
                                                                                <span v-else-if="layout_mode === 'rates' && item.content.rate" :style="{ backgroundColor: getObjectByKey(rates, 'id', item.content.rate).color }"></span>
                                                                                <span v-else-if="layout_mode === 'condition_sets' && item.content.condition_set" :style="{ backgroundColor: getObjectByKey(condition_sets, 'id', item.content.condition_set).color }"></span>
                                                                                <span v-else-if="layout_mode === 'replicates' && item.content.replicate" :style="{ backgroundColor: getObjectByKey(replicates, 'id', item.content.replicate).color }"></span>
                                                                                <div class="well-info" v-if="item.content.role" :data-fi-tooltip="render_tooltip_content(item.id)" :data-fi-class="tooltip_class(item.id)" :data-fi-offset="tooltip_offset"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                 </template>
                                                            </drag-select>

                                                            <div class="drag-select-container" v-else>
                                                                <div class="drag-select-inner fi-clearfix">
                                                                    <div v-for="item in layout.wells"
                                                                     :attr="item.id"
                                                                     @mouseover="well_mouseover(item.id)"
                                                                     @mouseout="well_mouseout(item.id)"
                                                                     class="well"
                                                                     :class="{
                                                                         'disabled': item.disable
                                                                     }">
                                                                     <div class="well-inner"
                                                                     :class="{
                                                                         'selected': selected_wells.includes(String(item.id)) || temp_selection.includes(String(item.id)),
                                                                         'role-set': item.content.role,
                                                                         'highlighted': item.highlight
                                                                        }">
                                                                         <div v-if="item.content" class="well-content">
                                                                             <span v-if="item.content.role === 'empty'" class="empty"><span class="xl"></span><span class="xr"></span></span>
                                                                             <span v-else-if="layout_mode === 'roles' && item.content.role
                                                                             ||
                                                                             (
                                                                                 layout_mode === 'test_samples' && item.content.role !== 'test_sample'
                                                                                 ||
                                                                                 layout_mode === 'ctrl_w_samples' && item.content.role !== 'ctrl_w_sample'
                                                                                 ||
                                                                                 layout_mode === 'ctrl_wo_samples' && item.content.role !== 'ctrl_wo_sample'
                                                                                 ||
                                                                                 layout_mode === 'rates' && item.content.role === 'ctrl_wo_sample'
                                                                             )
                                                                             " :style="{ backgroundColor: role_colors[item.content.role] }"></span>
                                                                             <span v-else-if="layout_mode === 'test_samples' && item.content.test_sample" :style="{ backgroundColor: getObjectByKey(test_samples, 'id', item.content.test_sample).color }"></span>
                                                                             <span v-else-if="layout_mode === 'ctrl_w_samples' && item.content.ctrl_w_sample" :style="{ backgroundColor: getObjectByKey(ctrl_w_samples, 'id', item.content.ctrl_w_sample).color }"></span>
                                                                             <span v-else-if="layout_mode === 'ctrl_wo_samples' && item.content.ctrl_wo_sample" :style="{ backgroundColor: getObjectByKey(ctrl_wo_samples, 'id', item.content.ctrl_wo_sample).color }"></span>
                                                                             <span v-else-if="layout_mode === 'rates' && item.content.rate" :style="{ backgroundColor: getObjectByKey(rates, 'id', item.content.rate).color }"></span>
                                                                             <span v-else-if="layout_mode === 'condition_sets' && item.content.condition_set" :style="{ backgroundColor: getObjectByKey(condition_sets, 'id', item.content.condition_set).color }"></span>
                                                                             <span v-else-if="layout_mode === 'replicates' && item.content.replicate" :style="{ backgroundColor: getObjectByKey(replicates, 'id', item.content.replicate).color }"></span>
                                                                             <div class="well-info" v-if="item.content.role" :data-fi-tooltip="render_tooltip_content(item.id)" :data-fi-class="tooltip_class(item.id)" :data-fi-offset="tooltip_offset"></div>
                                                                         </div>
                                                                     </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="back-drop"></div>

                                                        </div>

                                                    </div>

                                                </div>

                                                <div class="keymap">
                                                    <div class="keymap-section">
                                                        <h5>Key</h5>
                                                        <ul class="fi-list">
                                                            <li v-if="unset_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'role_not_set', 'active-selection': edit_mode && highlight_by === 'role_not_set', 'none': !unset_count || layout_mode !== 'roles'}">
                                                                <div class="color-key-button" @click="highlight('role_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle unset"></span>Role not set ({{ unset_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="test_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'role_test_sample', 'active-selection': edit_mode && highlight_by === 'role_test_sample', 'none': !test_sample_count || layout_mode === 'ctrl_w_samples' || layout_mode === 'ctrl_wo_samples'}">
                                                                <div class="color-key-button" @click="highlight('role_test_sample')" v-click-outside="reset_highlight_click_outside">
                                                                    <span v-if="layout_mode === 'roles' || layout_mode === 'ctrl_w_samples' || layout_mode === 'ctrl_wo_samples'" class="circle" :style="{ backgroundColor: role_colors['test_sample'] }"></span>
                                                                    <span v-else class="circle"><i class="far fa-minus"></i></span>
                                                                    Test Samples ({{ test_sample_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="ctrl_w_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'role_ctrl_w_sample', 'active-selection': edit_mode && highlight_by === 'role_ctrl_w_sample', 'none': !ctrl_w_sample_count || layout_mode === 'test_samples' || layout_mode === 'ctrl_wo_samples'}">
                                                                <div class="color-key-button" @click="highlight('role_ctrl_w_sample')" v-click-outside="reset_highlight_click_outside">
                                                                    <span v-if="layout_mode === 'roles' || layout_mode === 'test_samples' || layout_mode === 'ctrl_wo_samples'" class="circle" :style="{ backgroundColor: role_colors['ctrl_w_sample'] }"></span>
                                                                    <span v-else class="circle"><i class="far fa-minus"></i></span>
                                                                    Controls with Samples ({{ ctrl_w_sample_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="ctrl_wo_sample_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'role_ctrl_wo_sample', 'active-selection': edit_mode && highlight_by === 'role_ctrl_wo_sample', 'none': !ctrl_wo_sample_count || layout_mode === 'test_samples' || layout_mode === 'ctrl_w_samples' || layout_mode === 'rates'}">
                                                                <div class="color-key-button" @click="highlight('role_ctrl_wo_sample')" v-click-outside="reset_highlight_click_outside">
                                                                    <span v-if="layout_mode === 'roles' || layout_mode === 'test_samples' || layout_mode === 'ctrl_w_samples' || layout_mode === 'rates'" class="circle" :style="{ backgroundColor: role_colors['ctrl_wo_sample'] }"></span>
                                                                    <span v-else class="circle"><i class="far fa-minus"></i></span>
                                                                    Controls without Samples ({{ ctrl_wo_sample_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="empty_count" class="color-key" :class="{'active': !edit_mode && highlight_by === 'empty', 'active-selection': edit_mode && highlight_by === 'empty', 'none': !empty_count || layout_mode !== 'roles', 'disabled': layout_mode !== 'roles'}">
                                                                <div class="color-key-button" @click="highlight('empty')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle empty"><span class="xl"></span><span class="xr"></span></span>Empty ({{ empty_count }})
                                                                </div>
                                                            </li>

                                                            <li v-if="test_sample_not_set_count && layout_mode === 'test_samples'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'test_sample_not_set', 'active-selection': edit_mode && highlight_by === 'test_sample_not_set', 'none': !test_sample_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('test_sample_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle test-sample-not-set"></span>Test Sample # not set ({{ test_sample_not_set_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="ctrl_w_sample_not_set_count && layout_mode === 'ctrl_w_samples'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_w_sample_not_set', 'active-selection': edit_mode && highlight_by === 'ctrl_w_sample_not_set', 'none': !ctrl_w_sample_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('ctrl_w_sample_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle ctrl-w-sample-not-set"></span>Control with Sample # not set ({{ ctrl_w_sample_not_set_count }})
                                                                </div>
                                                            </li>
                                                            <li v-if="ctrl_wo_sample_not_set_count && layout_mode === 'ctrl_wo_samples'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_wo_sample_not_set', 'active-selection': edit_mode && highlight_by === 'ctrl_wo_sample_not_set', 'none': !ctrl_wo_sample_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('ctrl_wo_sample_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle ctrl-wo-sample-not-set"></span>Control without Sample # not set ({{ ctrl_wo_sample_not_set_count }})
                                                                </div>
                                                            </li>

                                                            <li v-if="rate_not_set_count && layout_mode === 'rates'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'rate_not_set', 'active-selection': edit_mode && highlight_by === 'rate_not_set', 'none': !rate_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('rate_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle rate-not-set"></span>Rate not set ({{ rate_not_set_count }})
                                                                </div>
                                                            </li>

                                                            <li v-if="condition_set_not_set_count && layout_mode === 'condition_sets'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'condition_set_not_set', 'active-selection': edit_mode && highlight_by === 'condition_set_not_set', 'none': !condition_set_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('condition_set_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle condition-set-not-set"></span>Condition Set not set ({{ condition_set_not_set_count }})
                                                                </div>
                                                            </li>

                                                            <li v-if="replicate_not_set_count && layout_mode === 'replicates'" class="color-key" :class="{'active': !edit_mode && highlight_by === 'replicate_not_set', 'active-selection': edit_mode && highlight_by === 'replicate_not_set', 'none': !replicate_not_set_count}">
                                                                <div class="color-key-button" @click="highlight('replicate_not_set')" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle replicate-not-set"></span>Replicate not set ({{ replicate_not_set_count }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div v-if="layout_mode === 'test_samples' && sorted_test_samples.length" class="keymap-section">
                                                        <h5>Test Sample #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="test_sample in sorted_test_samples" class="color-key" :class="{'active': !edit_mode && highlight_by === 'test_sample' && highlight_id == test_sample.id, 'active-selection': edit_mode && highlight_by === 'test_sample' && highlight_id == test_sample.id}">
                                                                <div class="color-key-button" @click="highlight('test_sample', test_sample.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: test_sample.color }"></span>{{ test_sample.id }} ({{ count_wells_by('test_sample', test_sample.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div v-if="layout_mode === 'ctrl_w_samples' && sorted_ctrl_w_samples.length" class="keymap-section">
                                                        <h5>Controls with Sample #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="ctrl_w_sample in sorted_ctrl_w_samples" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_w_sample' && highlight_id == ctrl_w_sample.id, 'active-selection': edit_mode && highlight_by === 'ctrl_w_sample' && highlight_id == ctrl_w_sample.id}">
                                                                <div class="color-key-button" @click="highlight('ctrl_w_sample', ctrl_w_sample.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: ctrl_w_sample.color }"></span>{{ ctrl_w_sample.id }} ({{ count_wells_by('ctrl_w_sample', ctrl_w_sample.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div v-if="layout_mode === 'ctrl_wo_samples' && sorted_ctrl_wo_samples.length" class="keymap-section">
                                                        <h5>Controls without Sample #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="ctrl_wo_sample in sorted_ctrl_wo_samples" class="color-key" :class="{'active': !edit_mode && highlight_by === 'ctrl_wo_sample' && highlight_id == ctrl_wo_sample.id, 'active-selection': edit_mode && highlight_by === 'ctrl_wo_sample' && highlight_id == ctrl_wo_sample.id}">
                                                                <div class="color-key-button" @click="highlight('ctrl_wo_sample', ctrl_wo_sample.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: ctrl_wo_sample.color }"></span>{{ ctrl_wo_sample.id }} ({{ count_wells_by('ctrl_wo_sample', ctrl_wo_sample.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                    <div v-if="layout_mode === 'rates' && sorted_rates.length" class="keymap-section">
                                                        <h5>Rate #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="rate in sorted_rates" class="color-key" :class="{'active': !edit_mode && highlight_by === 'rate' && highlight_id == rate.id, 'active-selection': edit_mode && highlight_by === 'rate' && highlight_id == rate.id}">
                                                                <div class="color-key-button" @click="highlight('rate', rate.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: rate.color }"></span>{{ rate.id }} ({{ count_wells_by('rate', rate.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                    <div v-if="layout_mode === 'condition_sets' && sorted_condition_sets.length" class="keymap-section">
                                                        <h5>Condition Set #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="condition_set in sorted_condition_sets" class="color-key" :class="{'active': !edit_mode && highlight_by === 'condition_set' && highlight_id == condition_set.id, 'active-selection': edit_mode && highlight_by === 'condition_set' && highlight_id == condition_set.id}">
                                                                <div class="color-key-button" @click="highlight('condition_set', condition_set.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: condition_set.color }"></span>{{ condition_set.id }} ({{ count_wells_by('condition_set', condition_set.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                    <div v-if="layout_mode === 'replicates' && sorted_replicates.length" class="keymap-section">
                                                        <h5>Replicate #s</h5>
                                                        <ul class="fi-list number-keys">
                                                            <li v-for="replicate in sorted_replicates" class="color-key" :class="{'active': !edit_mode && highlight_by === 'replicate' && highlight_id == replicate.id, 'active-selection': edit_mode && highlight_by === 'replicate' && highlight_id == replicate.id}">
                                                                <div class="color-key-button" @click="highlight('replicate', replicate.id)" v-click-outside="reset_highlight_click_outside">
                                                                    <span class="circle" :style="{ backgroundColor: replicate.color }"></span>{{ replicate.id }} ({{ count_wells_by('replicate', replicate.id) }})
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>

                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="auto_set_modal fi-modal fi-no-click-close">
            <div class="fi-modal-outer">
                <div class="fi-modal-inner">
                    <div class="fi-modal-content">

                        <div class="fi-modal-header">
                            <button type="button" class="fi-close-button fi-close-modal"></button>
                            <h3>Auto Set</h3>
                        </div>

                        <form @submit.prevent="submit_auto_set">

                            <div class="fi-modal-body">

                                <div class="fi-form">
                                    <div class="fi-form-field">
                                        <div class="fi-panel special">
                                            <strong>{{ selected_wells.length }}</strong> wells selected
                                        </div>
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">
                                            Starting
                                            <span v-if="layout_mode === 'samples'">Sample</span>
                                            <span v-else-if="layout_mode === 'rates'">Rate</span>
                                            <span v-else-if="layout_mode === 'condition_sets'">Condition Set</span>
                                            <span v-else-if="layout_mode === 'replicates'">Replicate</span>
                                            #
                                        </label>
                                        <input type="number" class="fi-form-control" v-model="auto_set_data.starting_number" data-fi-focus-start />
                                    </div>
                                    <div class="fi-form-field">
                                        <label class="fi-form-label">Direction</label>
                                        <div class="button-group">
                                            <button type="button" class="fi-button fi-small" :class="{'fi-default': auto_set_data.direction !== 'across', 'fi-primary': auto_set_data.direction === 'across'}" @click.prevent="auto_set_data.direction = 'across'">Across</button>
                                            <button type="button" class="fi-button fi-small" :class="{'fi-default': auto_set_data.direction !== 'down', 'fi-primary': auto_set_data.direction === 'down'}" @click.prevent="auto_set_data.direction = 'down'">Down</button>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="fi-modal-footer fi-buttons-container fi-text-right">
                                <button type="button" class="fi-button fi-default fi-close-modal" @click.prevent="">Cancel</button>
                                <button type="submit" class="fi-button fi-primary" :disabled="!auto_set_data.starting_number || auto_set_data.direction == 0">Auto Set</button>
                            </div>

                        </form>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="js/vue.js?v0.16"></script>
    <script src="js/drag-select.js?v0.16"></script>

    <script src="js/Sortable.min.js"></script>
    <script src="js/vuedraggable.umd.min.js"></script>

    <script src="js/app.js?v0.16"></script>

    <script>
        var edit_layout_id = 1;
    </script>
    <script src="js/create-app.js?v0.16"></script>

    <script>
        jQuery(document).on('click', '.plate-exp-container .well', function () {
            var index = parseInt(jQuery(this).index());
            var id = parseInt(app.plates[app.current_plate_index].wells[index].content);
            if (id && app.overall_selected_wells.length === 1) {
                var position = jQuery('.treatment-list .treatment-item').eq(id - 1).position().top;
                app.selected_treatments  = [id.toString()];
                jQuery('.treatments-inner').animate({ scrollTop: position - 40 }, 250 );
            }
        });
        jQuery(document).on('click', '.treatment-list .treatment-item', function () {
            var item = jQuery(this);
            var place = jQuery.trim(item.find('.cell.place').text());
            if (place !== 'Unplaced') {
                var id = jQuery.trim(item.find('.cell.id').text());
                var well = app.getObjectByKey(app.plates[app.current_plate_index].wells, 'content', id);
                if (well) {
                    app.selected_wells  = [well.id.toString()];
                }
            }
        });
        jQuery(document).on('fi-modal:hidden', '.edit-modal', function() {
            create_app.edit_mode = false;
        });
    </script>
</body>
</html>
